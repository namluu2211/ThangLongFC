<!-- Extracted template from players.component.ts (partial) -->
<div class="modern-container">
  <div class="players-orchestrator">
    <section class="players-header">
            <h2 id="playersHeading" class="page-title"><i class="fas fa-users me-2"></i>⚽ Quản lý đội hình</h2>
            <p id="playersSubheading" class="page-subtitle">Chia đội và ghi nhận thành tích trận đấu</p>
    </section>

    <section class="players-actions">
      <button class="modern-btn btn-info" (click)="togglePlayerListView()">
        <i class="fas fa-list me-2"></i>{{ showPlayerList ? 'Ẩn danh sách' : 'Hiện danh sách' }}
      </button>
      <button class="modern-btn btn-warning" [class.btn-danger]="useRegistered && registeredPlayers.length === 0" (click)="toggleUseRegistered()">
        <i class="fas fa-toggle-on me-2"></i>{{ useRegistered ? 'Chỉ đã đăng ký (' + registeredPlayers.length + ')' : 'Dùng tất cả (' + allPlayers.length + ')' }}
      </button>
      <button class="modern-btn btn-outline-secondary btn-sm" (click)="clearRegisteredPlayers()"><i class="fas fa-trash me-1"></i>Xóa đăng ký</button>
      <button class="modern-btn btn-primary" [disabled]="!canDivideTeams()" (click)="shuffleTeams()">
        <i class="fas fa-shuffle me-2"></i>Chia đội
      </button>
      <button class="modern-btn btn-success" (click)="saveMatchInfo()" [disabled]="teamA.length === 0 && teamB.length === 0">
        <i class="fas fa-save me-2"></i>Lưu trận đấu
      </button>
      <small class="text-muted ms-3">{{ getPlayerModeStatus() }}</small>
    </section>

    <app-player-list
      [showPlayerList]="showPlayerList"
      [paginatedPlayers]="getPaginatedPlayers()"
      [displayPlayers]="getDisplayPlayers()"
      [pageSize]="pageSize"
      [currentPage]="currentPage"
      [totalPages]="totalPages"
      [registeredPlayers]="registeredPlayers"
      (toggleRegistration)="toggleRegistration($event)"
      (previousPage)="previousPage()"
      (nextPage)="nextPage()"
      (savePlayers)="savePlayers()"
      (viewPlayer)="viewPlayer($event)"
      (toggleList)="togglePlayerListView()"
      (reload)="loadPlayers()"
      (createPlayer)="createNewPlayer($event)"
      (updatePlayer)="updateExistingPlayer($event.player, $event.updates)"
      (deletePlayer)="deletePlayer($event)"
    ></app-player-list>

    <app-teams-panel
      [teamA]="teamA"
      [teamB]="teamB"
      [scoreA]="scoreA"
      [scoreB]="scoreB"
      (scoreAChange)="scoreA = $event"
      (scoreBChange)="scoreB = $event"
      (removePlayer)="removeFromTeam($event.player, $event.team)"
    ></app-teams-panel>

    <!-- Lazy drag & drop loader -->
    <div class="mt-2" *ngIf="teamA.length || teamB.length">
        <button class="modern-btn btn-outline-primary btn-sm" (click)="loadDnd()" *ngIf="!dndLoaded" aria-label="Enable drag and drop for teams">Bật chế độ kéo thả</button>
    </div>
    <ng-container *ngIf="dndLoaded">
      <ng-container *ngComponentOutlet="dndComponent; inputs: { teamA: teamA, teamB: teamB, removePlayer: removeFromTeamBound, teamDrop: teamDropBound }"></ng-container>
    </ng-container>

    <div class="mt-3" *ngIf="teamA.length && teamB.length">
        <button class="modern-btn btn-outline-info btn-sm" (click)="loadAIComponent()" *ngIf="!aiLoaded" aria-label="Enable AI analysis">Bật phân tích AI</button>
    </div>
    <ng-container *ngIf="aiLoaded">
      <ng-container *ngComponentOutlet="aiComponent; inputs: { teamA: teamA, teamB: teamB, ai: aiAnalysisResults, isAnalyzing: isAnalyzing, runAnalysis: runAIAnalysis }"></ng-container>
    </ng-container>

    <app-finance-panel
      [thu]="thu"
      [chi_total]="chi_total"
      [chi_nuoc]="chi_nuoc"
      [chi_san]="chi_san"
      [chi_trongtai]="chi_trongtai"
      (thuChange)="thu=$event"
      (chiTotalChange)="chi_total=$event"
      (chiNuocChange)="chi_nuoc=$event"
      (chiSanChange)="chi_san=$event"
      (chiTrongTaiChange)="chi_trongtai=$event"
    ></app-finance-panel>

    <app-player-rankings
      [topPlayers]="topPlayers"
      [showPlayerRankings]="showPlayerRankings"
      [getPlayerAvatarByName]="getPlayerAvatarByName"
      [calculatePlayerScore]="calculatePlayerScore"
      (toggleRankings)="togglePlayerRankings()"
    ></app-player-rankings>
  </div>
